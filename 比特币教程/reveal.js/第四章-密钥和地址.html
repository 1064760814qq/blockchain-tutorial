<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>reveal.js – The HTML Presentation Framework</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>第四章 密钥和地址</h1>
				</section>

				<section data-markdown>
                    ## 简介
                    - 比特币的所有权是通过数字密钥、比特币地址和数字签名来确定的。
                    - 数字密钥实际上并不存储在网络中，而是由用户生成之后，存储在钱包或数据库中。
                    - 存储在用户钱包中的数字密钥完全独立于比特币协议，可由用户的钱包软件生成并管理，而无需参照区块链或访问网络。
                    - 密钥实现了比特币的许多有趣特性，包括去中心化信任和控制、所有权认证和基于密码学证明的安全模型。
				</section>

				<section data-markdown>
                    ## 简介
                    - 大多数比特币交易都需要一个有效的签名才会被存储在区块链。
                    - 只有有效的密钥才能产生有效的数字签名，因此拥有密钥副本就拥有了对该帐户的比特币的控制权。
                    - 用于支出资金的数字签名也称为见证（witness）。
                    - 比特币交易中的见证数据证明了所花费的比特币真正归谁所有。
				</section>

				<section data-markdown>
                    ## 简介
                    - 密钥是成对出现的，由一个私钥和一个公钥所组成。(非对称加密)
                    - 公钥就像银行的帐号，而私钥就像控制账户的PIN码或支票的签名。
                    - 比特币的用户很少会直接看到数字密钥。一般情况下，它们被存储在钱包文件内，由比特币钱包软件进行管理。
				</section>
				
				<section data-markdown>
                    ## 简介
                    - 在比特币交易的支付环节，收件人的公钥是通过其数字指纹代表的，称为比特币地址，就像支票上的支付对象的名字（即“收款方”）。
                    - 一般情况下，比特币地址由一个公钥生成并对应于这个公钥。
                    - 并非所有比特币地址都是公钥；他们也可以代表其他支付对象，譬如脚本。
                </section>

                <section data-markdown>
                    ## 简介
                    - 比特币地址把收款方抽象起来，使得交易的目的地更灵活。
                    - 就像支票一样：这个支付工具可支付到个人账户、公司账户，进行账单支付或现金支付。
                    - 用户的比特币地址可以公开出来。
				</section>

				<section data-markdown>
                    ## 公钥加密和加密货币
                    - 公钥加密发明于20世纪70年代。它是计算机和信息安全的数学基础。
                    - 自从公钥加密被发明之后，一些合适的数学函数被发现，譬如：素数幂和椭圆曲线乘法。
                    - 这些数学函数都是不可逆的，就是说很容易向一个方向计算，但不可以向相反方向倒推。
                    - 基于这些数学函数的密码学，使得生成数字密钥和不可伪造的数字签名成为可能。
                    - 比特币正是使用椭圆曲线乘法作为其公钥加密的基础。
                </section>
                
                <section data-markdown>
                    ## 公钥加密和加密货币
                    - 在比特币系统中，我们用公钥加密创建一个密钥对，用于控制比特币的获取。
                    - 密钥对包括一个私钥，和由其衍生出的唯一的公钥。
                    - 公钥用于接收比特币，而私钥用于比特币支付时的交易签名。
                </section>

				<section data-markdown>
                    ## 公钥加密和加密货币
                    - 公钥和私钥之间的数学关系，使得私钥可用于生成特定消息的签名。此签名可以在不泄露私钥的同时对公钥进行验证。
                    - 支付比特币时，比特币的当前所有者需要在交易中提交其公钥和签名（每次交易的签名都不同，但均从同一个私钥生成）。
                    - 比特币网络中的所有人都可以通过所提交的公钥和签名进行验证，并确认该交易是否有效，即确认支付者在该时刻对所交易的比特币拥有所有权。
				</section>

				<section data-markdown>
                    ## 公钥加密和加密货币
                    - 大多数比特币钱包工具为了方便会将私钥和公钥以密钥对的形式存储在一起。然而，公钥可以由私钥计算得到，所以只存储私钥也是可以的。
				</section>

				<section data-markdown>
					## 私钥和公钥
					- 一个比特币钱包中包含一系列的密钥对，每个密钥对包括一个私钥和一个公钥。
					- 私钥（k）是一个数字，通常是随机选出的。
					- 有了私钥，我们就可以使用椭圆曲线乘法这个单向加密函数产生一个公钥（K）。
					- 有了公钥（K），我们就可以使用一个单向加密哈希函数生成比特币地址（A）。
				</section>

				<section data-markdown>
					[示意图](./images/key.png)
				</section>

				<section data-markdown>
					## 为什么使用非对称加密（公钥/私钥）？
					- 它不是用于“加密”交易。相反，非对称密码学的具有生成数字签名的能力。
					- 可以将私钥应用于交易的数字指纹以产生数字签名。该签名只能由知晓私钥的人生成。
					- 但是，访问公钥和交易指纹的任何人都可以使用它们来验证签名。
					- 这种非对称密码学的适用性使得任何人都可以验证每笔交易的每个签名，同时确保只有私钥的所有者可以产生有效的签名。
				</section>

				<section data-markdown>
					## 私钥
					- 私钥就是一个随机选出的数字而已。
					- 一个比特币地址中的所有资金的控制取决于相应私钥的所有权和控制权。
					- 在比特币交易中，私钥用于生成支付比特币所必需的签名以证明对资金的所有权。
					- 私钥必须始终保持机密，因为一旦被泄露给第三方，相当于该私钥保护之下的比特币也拱手相让了。
					- 私钥还必须进行备份，以防意外丢失，因为私钥一旦丢失就难以复原，其所保护的比特币也将永远丢失。
				</section>

				<section data-markdown>
					## 私钥
					- 比特币私钥只是一个数字。
					- 你可以用硬币、铅笔和纸来随机生成你的私钥：掷硬币256次，用纸和笔记录正反面并转换为0和1，随机得到的256位二进制数字可作为比特币钱包的私钥。
					- 该私钥可进一步生成公钥。
				</section>

				<section data-markdown>
					## 从一个随机数生成私钥
					- 生成密钥的第一步也是最重要的一步，是要找到足够安全的熵源，即随机性来源。
					- 生成一个比特币私钥在本质上与“在1到2^256之间选一个数字”无异。
					- 只要选取的结果是不可预测或不可重复的，那么选取数字的具体方法并不重要。
					- 比特币软件使用操作系统底层的随机数生成器来产生256位的熵（随机性）。
					- 通常情况下，操作系统随机数生成器由人工的随机源进行初始化，这就是为什么也可能需要不停晃动鼠标几秒钟。
				</section>

				<section data-markdown>
					## 从一个随机数生成私钥
					- 更准确地说，私钥可以是1和n-1之间的任何数字，其中n是一个常数（n=1.158 * 10^77，略小于2^256），并被定义为由比特币所使用的椭圆曲线的阶。
					- 要生成这样的一个私钥，我们随机选择一个256位的数字，并检查它是否小于n-1。
					- 从编程的角度来看，一般是通过在一个密码学安全的随机源中取出一长串随机字节，对其使用SHA256哈希算法进行运算，这样就可以方便地产生一个256位的数字。
					- 如果运算结果小于n-1，我们就有了一个合适的私钥。否则，我们就用另一个随机数再重复一次。
				</section>

				<section data-markdown>
					## 警告
					- 不要自己写代码或使用你的编程语言提供的简易随机数生成器来获得一个随机数。
					- 使用密码学安全的伪随机数生成器（CSPRNG），并且需要有一个来自具有足够熵值的源的种子。
					- 使用随机数发生器的程序库时，需仔细研读其文档，以确保它是加密安全的。正确实施CSPRNG是密钥安全性的关键所在。
				</section>

				<section data-markdown>
					## 示例
					- 以下是一个随机生成的私钥（k），以十六进制格式表示（256位的二进制数，以64位十六进制数显示，每个十六进制数占4位）：
					- `1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD`
					- 比特币私钥空间的大小是2^256，这是一个非常大的数字。用十进制表示的话，大约是10^77，而宇宙被估计只含有10^80个原子。
				</section>

				<section data-markdown>
					## 使用比特币客户端生成私钥
					- 要使用比特币核心客户端生成一个新的密钥，可使用getnewaddress命令。
					- 出于安全考虑，命令运行后只显示生成的公钥，而不显示私钥。
					- 如果要bitcoind显示私钥，可以使用dumpprivkey命令。dumpprivkey命令会把私钥以Base58校验和编码格式显示，这种私钥格式被称为钱包导入格式。
				</section>

				<section data-markdown>
					## 示例
					```
					$ bitcoin-cli getnewaddress
					1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy
					$ bitcoin-cli dumpprivkey 1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy
					KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ
					```
				</section>

				<section data-markdown>
					## 解释
					- dumpprivkey命令打开钱包提取由getnewaddress命令生成的私钥。
					- dumpprivkey命令无法从公钥得到对应的私钥，因为这是不可能的。这个命令只是显示钱包中已有也就是由getnewaddress命令生成的私钥。
				</section>

				<section data-markdown>
				</section>

				<section data-markdown>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/search/search.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
